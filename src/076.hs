{-
Problem 76 「和の数え上げ」 †
===============================

5は数の和として6通りに書くことができる:

4 + 1
3 + 2
3 + 1 + 1
2 + 2 + 1
2 + 1 + 1 + 1
1 + 1 + 1 + 1 + 1

2つ以上の正整数の和としての100の表し方は何通りか.

解答
---------

数xをd個の和で表した時の個数をC(x,d)とすると

100の和の表し方は以下の通り

C(100,2): 99+1 ... 50+50:            100/2=50個

C(100,3): (98+1)+1 ... (50+49)+1:    C(99,2)
        + (96+2)+2 ... (49+49)+2:    C(98,2)-1 = C(95+1,2)と同じ個数 = C(96,2)
        + (94+3)+3 ... (49+48)+3:    C(97,2)-2 = C(92,2)
        + ...
        + (34+33)+33                 1         = C(3,2)
                                     = sum C(i,2), i<-[99,96..3]

C(100,4): (97+1+1)+1: C(99,3) - 0 = C(99,3)
        + (94+2+2)+2: C(98,3) - 2 = C(95,3)
        + (91+3+3)+3: C(97,3) - 5 = C(91,3)
        + (88+4+4)+4: C(97,3) - 9 = C(87,3)
        + (25+25+25)+25: 1        = C(3,3)
                                  = sum C(i,3), i<-[99,95..3]

C(100,5): (96+1+1+1)+1: = C(99,4)
        + (92+2+2+2)+2: = C(91+1+1+1,4) = C(94,4)
        + (88+3+3+3)+3: = C(86+1+1+1,4) = C(89,4)
                        = sum C(i,4), i<-[99,94..4]

つまり、漸化式で表せる。
C(x,d) = sum C(x-1-i, d-1), i<-[0,d,2*d..(x-1)]

C(100) = sum C(100,i), i<-[2..100]

--> 7秒くらいで出た。
-}

main = print $ answer 100

answer :: Int -> Int
answer x = sum [count x d | d<-[2..x]]

count :: Int -> Int -> Int
count x 2 = x `div` 2
count x d = sum [count (x-1-i) (d-1) | i<-[0,d..(x-1)]]
